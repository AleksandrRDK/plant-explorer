import{j as s,r as c}from"./index-QA4upJhH.js";import{N as j}from"./Navigation-RylKqguU.js";import{a as x}from"./index-Dq7h7Pqt.js";const N=({page:e,setPage:t,hasNextPage:a})=>{const n=()=>{e>1&&t(e-1)},r=()=>{a&&t(e+1)};return s.jsxs("div",{className:"pagination",children:[s.jsx("button",{className:"pagination__button",onClick:n,disabled:e===1,children:"← Назад"}),s.jsxs("span",{className:"pagination__info",children:["Страница ",e]}),s.jsx("button",{className:"pagination__button",onClick:r,disabled:!a,children:"Вперёд →"})]})},f=({plant:e})=>{const{common_name:t,scientific_name:a,family:n,default_image:r,genus:l,species_epithet:m,hybrid:h}=e,o="/plant-explorer/images/placeholder.png",[i,d]=c.useState((r==null?void 0:r.regular_url)??o),p=()=>{i!==o&&d(o)};return s.jsxs("div",{className:"plant-card",children:[s.jsx("img",{src:i,alt:t||(a==null?void 0:a[0])||"Неизвестное растение",className:`plant-card__image ${i===o?"plant-card__image--placeholder":""}`,onError:p}),s.jsxs("div",{className:"plant-card__body",children:[s.jsx("h2",{className:"plant-card__name",children:t||"Без названия"}),s.jsx("p",{className:"plant-card__scientific",children:s.jsx("em",{children:a==null?void 0:a.join(", ")})}),s.jsxs("p",{className:"plant-card__genus",children:["Род: ",s.jsx("strong",{children:l})]}),s.jsxs("p",{className:"plant-card__species",children:["Вид: ",s.jsx("strong",{children:m})," ",h?"(гибрид)":""]}),n&&s.jsxs("p",{className:"plant-card__family",children:["Семейство: ",s.jsx("strong",{children:n})]})]})]})},b=({plants:e,isLoading:t})=>s.jsx("div",{className:"plant-grid",children:t?s.jsx("p",{className:"plant-grid__message",children:"Загрузка..."}):e.length>0?s.jsx("div",{className:"plant-grid__list",children:e.map(a=>s.jsx(f,{plant:a},a.id))}):s.jsx("p",{className:"plant-grid__message",children:"Ничего не найдено"})}),P=({query:e,setQuery:t,onSearch:a,isLoading:n})=>{const r=l=>{l.preventDefault(),a()};return s.jsxs("form",{className:"search-bar",onSubmit:r,children:[s.jsx("span",{className:"search-bar__label",children:"Поиск:"}),s.jsx("input",{className:"search-bar__input",type:"text",value:e,onChange:l=>t(l.target.value),placeholder:"Введите название растения...","aria-label":"Поиск растения"}),s.jsx("button",{className:"search-bar__button",disabled:n,children:n?"Поиск...":"Найти"})]})};async function S(e,t){try{let a="https://perenual.com/api/v2/species-list?key=sk-lo4s685937fe902ad11133";e!==void 0&&(a+=`&q=${encodeURIComponent(e)}`),t&&(a+=`&page=${t}`);const n=await x.get(a);return{plants:n.data.data,lastPage:n.data.last_page}}catch(a){return x.isAxiosError(a)?(console.error("Axios error:",a.message),{plants:[],lastPage:1}):(console.error("Unexpected error:",a),{plants:[],lastPage:1})}}const k=()=>{const[e,t]=c.useState(""),[a,n]=c.useState(""),[r,l]=c.useState(1),[m,h]=c.useState(1),[o,i]=c.useState([]),[d,p]=c.useState(!1);c.useEffect(()=>{(async()=>{p(!0);const{plants:g,lastPage:_}=await S(a,r);i(g),h(_),p(!1)})()},[a,r]);const u=()=>{l(1),n(e)};return s.jsxs(s.Fragment,{children:[s.jsx(j,{}),s.jsx("div",{className:"nav__offset"}),s.jsxs("main",{className:"search-page",children:[s.jsx(P,{query:e,setQuery:t,onSearch:u,isLoading:d}),s.jsx(b,{plants:o,isLoading:d}),d?null:s.jsx(N,{page:r,setPage:l,hasNextPage:r<m})]})]})};export{k as default};
