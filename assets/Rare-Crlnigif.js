import{j as e,r as a}from"./index-nTyzLkKk.js";import{N as w}from"./Navigation-Bw07VmXH.js";import{a as k}from"./index-Dq7h7Pqt.js";async function y(s){try{const o=(await k.get(`https://api.inaturalist.org/v1/observations?taxon_id=47126&threatened=true&order=asc&page=${s}&per_page=20`)).data.results,l=new Map;return o.forEach(d=>{var m;const c=(m=d.taxon)==null?void 0:m.preferred_common_name;c&&!l.has(c)&&l.set(c,d)}),Array.from(l.values())}catch(r){return console.error(r),[]}}const S=({taxon:s,obs:r})=>s?e.jsxs("div",{className:"rare__info",children:[e.jsxs("div",{className:"rare__info-header",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"–ù–∞–∑–≤–∞–Ω–∏–µ:"})," ",s.preferred_common_name||"–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"–ù–∞—É—á–Ω–æ–µ –∏–º—è:"})," ",s.scientific_name||"–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö"]})]}),e.jsxs("div",{className:"rare__info-columns",children:[e.jsxs("div",{className:"rare__info-column",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"–†–∞–Ω–≥:"})," ",s.rank||"–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"–ö–∞—Ç–µ–≥–æ—Ä–∏—è:"})," ",s.iconic_taxon_name||"–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"–í—ã–º–µ—Ä—à–∏–π –≤–∏–¥:"})," ",s.extinct?"–¥–∞":"–Ω–µ—Ç"]})]}),e.jsxs("div",{className:"rare__info-column",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"–î–∞—Ç–∞:"})," ",r.observed_on?new Date(r.observed_on).toLocaleDateString():"–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å:"})," ",r.created_time_zone||"–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ID —Å–æ–æ–±—â–µ—Å—Ç–≤–∞:"})," ",r.community_taxon_id||"–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"–ú–µ—Å—Ç–æ:"})," ",r.place_guess||"–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö"]})]})]}),e.jsxs("p",{className:"rare__description",children:[e.jsx("strong",{children:"–û–ø–∏—Å–∞–Ω–∏–µ:"})," ",r.description||"–Ω–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è."]}),s.wikipedia_url?e.jsx("p",{className:"rare__wiki",children:e.jsx("a",{href:s.wikipedia_url,target:"_blank",rel:"noopener noreferrer",children:"–ü–æ–¥—Ä–æ–±–Ω–µ–µ –Ω–∞ Wikipedia"})}):e.jsx("p",{className:"rare__wiki",children:"–°—Å—ã–ª–∫–∞ –Ω–∞ Wikipedia –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç."})]}):null,E=({setIsOpenModal:s,modalImageUrl:r})=>e.jsx("div",{className:"modal",onClick:()=>s(!1),children:e.jsxs("div",{className:"modal__content",onClick:o=>o.stopPropagation(),children:[e.jsx("button",{className:"modal__close",onClick:()=>s(!1),children:"√ó"}),e.jsx("img",{src:r,alt:"–£–≤–µ–ª–∏—á–µ–Ω–Ω–æ–µ —Ñ–æ—Ç–æ —Ä–∞—Å—Ç–µ–Ω–∏—è",className:"modal__image"})]})}),C=()=>{const[s,r]=a.useState([]),[o,l]=a.useState(!1),[d,c]=a.useState(null),[m,p]=a.useState(1),[_,g]=a.useState(!0),[N,x]=a.useState(!1),[f,v]=a.useState(null),u=a.useRef(!1),h=a.useCallback(async n=>{if(!(u.current||!_)){u.current=!0,l(!0),c(null);try{const i=await y(n);i.length===0?g(!1):(r(t=>[...t,...i]),p(n+1))}catch(i){c("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö."),console.error(i)}finally{u.current=!1,l(!1)}}},[_]);return a.useEffect(()=>{h(1)},[]),a.useEffect(()=>{const n=()=>{window.innerHeight+window.scrollY>=document.body.offsetHeight-300&&!u.current&&_&&h(m)};return window.addEventListener("scroll",n),()=>window.removeEventListener("scroll",n)},[h,m,_]),e.jsxs(e.Fragment,{children:[e.jsx(w,{}),e.jsx("div",{className:"nav__offset"}),e.jsxs("main",{className:"rare",children:[e.jsx("h1",{className:"rare__title",children:"–†–µ–¥–∫–∏–µ –≤–∏–¥—ã —Ä–∞—Å—Ç–µ–Ω–∏–π"}),d&&e.jsx("p",{className:"rare__error",children:d}),e.jsx("ul",{className:"rare__list",children:s.map((n,i)=>{const t=n.taxon;return t?e.jsxs("li",{className:"rare__item",children:[e.jsx("div",{className:"rare__item-img__wrapper",children:t.default_photo?e.jsx("img",{src:t.default_photo.medium_url,alt:t.preferred_common_name||t.scientific_name||"–§–æ—Ç–æ —Ä–∞—Å—Ç–µ–Ω–∏—è",className:"rare__image",loading:"lazy",onClick:()=>{var j;v(((j=t.default_photo)==null?void 0:j.medium_url)||null),x(!0)}}):e.jsx("div",{className:"rare__image_placeholder",children:"–ù–µ—Ç —Ñ–æ—Ç–æ"})}),e.jsx(S,{taxon:t,obs:n})]},`${n.id}-${i}`):null})}),o&&e.jsx("p",{className:"rare__status",children:"–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã..."}),!_&&e.jsx("p",{className:"rare__status",children:"–≠—Ç–æ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ üå±"}),N&&f&&e.jsx(E,{setIsOpenModal:x,modalImageUrl:f})]})]})};export{C as default};
